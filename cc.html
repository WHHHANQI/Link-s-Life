<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For CC - Success Journal</title>
    <link rel="stylesheet" href="css/style.css?v=2">
    <style>
        /* ä¸“å±é…è‰²å¾®è°ƒï¼šç»™å¥¹çš„é¡µé¢åŠ ä¸€ç‚¹ç‚¹æ¸©æš–çš„ç²‰è‰²è°ƒè£…é¥° */
        .card h2::before { background-color: #ec4899; box-shadow: 0 0 10px #ec4899; }
        .journal-date { color: #ec4899; background: rgba(236, 72, 153, 0.05); }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h2>ğŸ’– é™ˆé™ˆçš„æˆåŠŸæ—¥è®° (CC's Journal)</h2>
            <p style="font-size: 0.8rem; color: #64748b;">
                äº²çˆ±çš„é™ˆé™ˆï¼Œè®°å½•ä¸‹ä»Šå¤©å‘ç”Ÿçš„å°ç¡®å¹¸æˆ–å°æˆå°±å§~<br>
                Record your daily wins, my dear CC.
            </p>
            
            <input id="dateInput" type="date">
            
            <textarea id="journalInput" rows="6" 
                style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-family: inherit;" 
                placeholder="1. ä»Šå¤©å–åˆ°äº†å¥½å–çš„å¥¶èŒ¶&#10;2. å®Œæˆäº†å·¥ä½œä»»åŠ¡&#10;3. å¼€å¿ƒï¼"></textarea>
            
            <button onclick="addJournal()" style="margin-top: 10px; width: 100%; background: linear-gradient(135deg, #ec4899, #db2777);">
                ğŸ’¾ ä¿å­˜ (Save for CC)
            </button>
        </div>

        <div id="journalGrid">
            </div>
    </div>

    <script src="js/db.js"></script>
    <script src="js/lock.js"></script>
    <script src="js/nav.js"></script>

    <script>
        // 1. ç”Ÿæˆå¯¼èˆªæ ï¼Œé¡µé¢ID è®¾ä¸º 'cc'
        renderNav('cc');

        const db = new GithubDB();
        // âš ï¸ å…³é”®ç‚¹ï¼šæ•°æ®å­˜åœ¨ä¸“å±çš„ cc_journal.json é‡Œï¼Œä¸å’Œä½ çš„æ··æ·†
        const FILE_NAME = "cc_journal.json"; 
        let localData = [];

        window.addEventListener('app-ready', async () => {
            document.getElementById('dateInput').valueAsDate = new Date();
            
            const data = await db.load(FILE_NAME);
            if(data) {
                localData = data;
                renderJournals();
            }
        });

        async function addJournal() {
            const date = document.getElementById('dateInput').value;
            const content = document.getElementById('journalInput').value;
            
            if(!content.trim()) return alert("å†™ç‚¹ä»€ä¹ˆå§~");

            const newEntry = { 
                id: Date.now(), 
                date, 
                content 
            };
            
            localData.push(newEntry);
            localData.sort((a,b) => new Date(b.date) - new Date(a.date));

            await db.save(FILE_NAME, localData);
            
            document.getElementById('journalInput').value = "";
            renderJournals();
        }

        function renderJournals() {
            const grid = document.getElementById('journalGrid');
            grid.innerHTML = "";
            
            localData.forEach(item => {
                grid.innerHTML += `
                    <div class="card">
                        <div class="journal-date">
                            <span>ğŸ“… ${item.date}</span>
                            <span style="cursor:pointer; opacity:0.6;" onclick="deleteJournal(${item.id})">Ã—</span>
                        </div>
                        <div class="journal-content" style="white-space: pre-wrap;">${item.content}</div>
                    </div>
                `;
            });
        }

        async function deleteJournal(id) {
            if(!confirm("ç¡®å®šåˆ é™¤è¿™æ¡å—ï¼Ÿ")) return;
            localData = localData.filter(i => i.id !== id);
            await db.save(FILE_NAME, localData);
            renderJournals();
        }
    </script>
</body>
</html>
