<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link's Advice</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="card">
            <h2>ğŸ’¡ ç»™è‡ªå·±çš„å»ºè®® (Advice to Myself)</h2>
            <p style="font-size: 0.8rem; color: #64748b;">
                å½“è¿·èŒ«æ—¶ï¼Œå¬å¬è¿‡å»æ¸…é†’çš„è‡ªå·±æ€ä¹ˆè¯´ã€‚<br>
                Listen to your clear-minded self when you are lost.
            </p>
            
            <textarea id="adviceInput" rows="4" 
                style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-family: inherit;" 
                placeholder="e.g. æ°¸è¿œä¸è¦åœ¨æ™šä¸Šåšå†³å®š (Never make decisions at night)..."></textarea>
            
            <button onclick="addAdvice()" style="margin-top: 10px; width: 100%;">ğŸ’¾ ä¿å­˜å»ºè®® (Save Advice)</button>
        </div>

        <div id="adviceGrid">
            </div>
    </div>

    <script src="js/db.js"></script>
    <script src="js/lock.js"></script>
    <script src="js/nav.js"></script> <script>
        // 1. ç”Ÿæˆå¯¼èˆªæ ï¼Œå¹¶å‘Šè¯‰å®ƒå½“å‰æ˜¯ 'advice' é¡µ
        renderNav('advice');

        const db = new GithubDB();
        const FILE_NAME = "my_advice.json";
        let localData = [];

        window.addEventListener('app-ready', async () => {
            const data = await db.load(FILE_NAME);
            if(data) {
                localData = data;
                renderAdvice();
            }
        });

        async function addAdvice() {
            const content = document.getElementById('adviceInput').value;
            if(!content.trim()) return;

            const newEntry = { 
                id: Date.now(), 
                content,
                date: new Date().toLocaleDateString()
            };
            
            localData.unshift(newEntry); // åŠ åˆ°æœ€å‰é¢
            await db.save(FILE_NAME, localData);
            
            document.getElementById('adviceInput').value = "";
            renderAdvice();
        }

        function renderAdvice() {
            const grid = document.getElementById('adviceGrid');
            grid.innerHTML = "";
            
            localData.forEach(item => {
                grid.innerHTML += `
                    <div class="card" style="border-left: 5px solid #fbbf24;">
                        <div style="font-weight:bold; color:#334155; margin-bottom:8px; white-space: pre-wrap;">${item.content}</div>
                        <div style="display:flex; justify-content:space-between; font-size:0.8rem; color:#94a3b8;">
                            <span>ğŸ“… ${item.date}</span>
                            <span style="cursor:pointer; color:#ef4444;" onclick="deleteAdvice(${item.id})">Delete</span>
                        </div>
                    </div>
                `;
            });
        }

        async function deleteAdvice(id) {
            if(!confirm("Remove this advice?")) return;
            localData = localData.filter(i => i.id !== id);
            await db.save(FILE_NAME, localData);
            renderAdvice();
        }
    </script>
</body>
</html>
